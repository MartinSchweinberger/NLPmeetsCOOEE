---
title: "Analysis of the Corpus of Oz Early English - Part 5: Error Analysis"
author: "Anonymous"
date: "`r format(Sys.time(), '%Y-%m-%d')`"
output:
  bookdown::html_document2: default
bibliography: Bibliography.bib
link-citations: yes
---

# Introduction

This document shows an analysis of Corpus of Oz Early English  (COOEE) [@fritz2004cooee]. 

## Aims

* Find keywords (part 2)

* Check for distribution of keywords by date (mosaic plot) (part 2)

* Create network of keywords (network analysis) (part 2)

* Find topics (topic modeling) (part 3)

* **Error analysis (misspelled words, words not in dictionary)**

# Set Up

In a first step, the session is prepared by installing packages.


```{r ampause_01_01, eval = F, message=FALSE, warning=FALSE}
# load packages
install.packages("tidyverse")
install.packages("tidytext")
install.packages("tidyr")
install.packages("tm")
install.packages("tokenizers")
install.packages("qdap")
install.packages("textstem")
install.packages("corpus")
```

Now, we activate the packages, set options, load relevant functions, and defining the path to the data.

```{r}
# set options
options(stringsAsFactors = F)
options(scipen = 999)
# load packages
library(tidyverse)
library(tidytext)
library(tidyr)
library(tm)
library(tokenizers)
library(qdap)
library(textstem)
library(corpus)
# for pos-tagging objects in R
source("D:\\R/POStagObject.R") 
```


In a next step, we load and process the data.

```{r}
# cooee
cooee_clean  <- base::readRDS(file = here::here("data", "cooee_clean.rda"))
# control
control_clean  <- base::readRDS(file = here::here("data", "control_clean.rda"))
```


# Pronounts

```{r}
pp <- cooeed_clean %>%
  dplyr::mutate(youse = stringr::str_count(Text, "\\byouse\\b|\\byous\\b"),
                ye = stringr::str_count(Text, "\\bye\\b")) %>%
  dplyr::group_by(Period) %>%
  dplyr::summarise(Words = sum(Words),
                   ye = sum(ye),
                   youse = sum(youse)) %>%
  dplyr::mutate(freq_youse = youse/Words*1000,
                freq_ye = ye/Words*1000,)
# inspect
head(pp)
```

```{r}
pp %>%
  tidyr::gather(Form, Frequency, freq_youse:freq_ye) %>%
  dplyr::mutate(Form = dplyr::case_when(Form == "freq_ye" ~ "ye",
                                        Form == "freq_youse" ~ "youse")) %>%
  ggplot(aes(x = Period, y = Frequency, group = Form, color = Form, linetype = Form)) +
  geom_line(size = 1.25) +
  theme_bw() +
  theme(legend.position = "top") +
    scale_colour_manual(labels = names(table(pp$Form)),
                      breaks = names(table(pp$Form)),
                      values = c("gray50", "gray80"), 
                      name = "") +
  scale_linetype_manual(labels = names(table(pp$Form)),
                        breaks = names(table(pp$Form)),
                        values = seq(1, 2, 1), 
                        name = "")
```

```{r}
pp2 <- cooeed_clean %>%
  dplyr::mutate(youse = stringr::str_count(Text, "\\byouse\\b|\\byous\\b"),
                ye = stringr::str_count(Text, "\\bye\\b")) %>%
  dplyr::group_by(Period) %>%
  dplyr::mutate(freq_youse = youse/Words*1000,
                freq_ye = ye/Words*1000) %>%
  tidyr::gather(Form, Frequency, freq_youse:freq_ye) %>%
    dplyr::mutate(Form = dplyr::case_when(Form == "freq_ye" ~ "ye",
                                        Form == "freq_youse" ~ "youse"))

pp2 %>%
  ggplot(aes(x = Period, y = Frequency, group = Form, color = Form, linetype = Form, group = Form)) +
  geom_smooth() +
  theme_bw() +
  theme(legend.position = "top") +
    scale_colour_manual(labels = names(table(pp2$Form)),
                      breaks = names(table(pp2$Form)),
                      values = c("gray50", "gray80"), 
                      name = "") +
  scale_linetype_manual(labels = names(table(pp2$Form)),
                        breaks = names(table(pp2$Form)),
                        values = seq(1, 2, 1), 
                        name = "")
```


# Errors

```{r}
idx <- cooeed_clean$Rawtext %>%
  stringr::str_count("\\[reg.*?\\/")
errors <- cooeed_clean$Rawtext %>%
  stringr::str_extract_all("\\[reg.*?\\/") %>%
  unlist()
errorswona <- errors[!is.na(errors)]
```


```{r}
error <- cooeed_clean %>%
  dplyr::select(Id, Corpus, File, Author, Date, Period) %>%
  dplyr::mutate(idx = idx) %>%
  dplyr::filter(idx != 0)
errortb <- error %>%
  dplyr::slice(rep(1:n(), idx)) %>%
  dplyr::mutate(errors = errorswona,
                correction = stringr::str_remove_all(errors, "\\[/.*")) %>%
  dplyr::mutate(correction = stringr::str_remove_all(correction, ".*\\]"),
                correction = stringr::str_squish(correction)) %>%
  dplyr::mutate(errors = stringr::str_remove_all(errors, "\\].*"),
                errors = stringr::str_remove_all(errors, ".*\\[reg"),
                errors = stringr::str_squish(errors)) %>%
  dplyr::select(-idx)
rownames(errortb) <- NULL
# inspect
head(errortb)
```


# Outro

```{r}
sessionInfo()
```


# References

