---
title: "Analysis of the Corpus of Oz Early English - Part 6: Mapping"
author: "Anonymous"
date: "`r format(Sys.time(), '%Y-%m-%d')`"
output:
  bookdown::html_document2: default
bibliography: Bibliography.bib
link-citations: yes
---

# Introduction

This document shows an analysis of Corpus of Oz Early English  (COOEE) [@fritz2004cooee]. 

## Aims

* Find keywords

* Check for distribution of keywords by date (mosaic plot)

* Create network of keywords (network analysis)

* Find topics (topic modeling) (part 3)

* Error analysis (misspelled words, words not in dictionary) (part 4)

# Set Up

In a first step, the session is prepared by installing packages.


```{r ampause_01_01, eval = F, message=FALSE, warning=FALSE}
# load packages
install.packages("tidyverse")
install.packages("tidytext")
install.packages("tidyr")
install.packages("tm")
install.packages("tokenizers")
install.packages("qdap")
install.packages("textstem")
install.packages("corpus")
install.packages("quanteda")
install.packages("quanteda.textstats")
install.packages("ngram")
```

Now, we activate the packages, set options, load relevant functions, and defining the path to the data.

```{r}
# set options
options(stringsAsFactors = F)
options(scipen = 999)
# load packages
library(tidyverse)
library(tidytext)
library(tidyr)
library(tm)
library(tokenizers)
library(qdap)
library(textstem)
library(corpus)
library(quanteda)
library(quanteda.textstats)
library(ngram)
# for pos-tagging objects in R
source("D:\\R/POStagObject.R") 
```


In a next step, we load and process the corpus data.


```{r}
# cooee
cooee_clean  <- base::readRDS(file = here::here("data", "cooeed_clean.rda"))
# control
control_clean  <- base::readRDS(file = here::here("data", "control_clean.rda"))
# inspect
nrow(cooee_clean); nrow(control_clean)
```


# Map

```{r}
head(cooee_clean)
```

```{r}
table(cooee_clean$PlaceWriting)
```


```{r}
# load packages
library(tmap) 
library(here)
library(rgdal)
# load shape files
ozmap <- readOGR(dsn = here::here("data/shapes", "AshmoreAndCartierIslands.shp"), stringsAsFactors = F)
```

```{r}
# convert the data into tidy format
ozmapt <- broom::tidy(ozmap, region = "name")
# inspect data
head(ozmapt)
```



```{r}
# extract names of states and their long and lat
cnames <- ozmapt %>%
  dplyr::group_by(id) %>%
  dplyr::summarise(long = mean(long),
                   lat = mean(lat)) %>%
  dplyr::filter(id != "Ashmore and Cartier Islands",
                id != "Christmas Island",
                id != "Cocos (Keeling) Islands",
                id != "Coral Sea Islands Territory",
                id != "Heard Island and McDonald Islands",
                id != "Jervis Bay Territory",
                id != "Norfolk Island",
                id != "Australian Capital Territory") %>%
  dplyr::mutate(long = ifelse(id == "Queensland", long-5, long ),      # to left
                long = ifelse(id == "New South Wales", long-2, long ),
                long = ifelse(id == "Northern Territory", long-1, long ),
                lat = ifelse(id == "New South Wales", lat+2, lat ),    # up
                lat = ifelse(id == "Northern Territory", lat-5, lat ),
                lat = ifelse(id == "Victoria", lat+1, lat ),
                lat = ifelse(id == "South Australia", lat+5, lat ),
                lat = ifelse(id == "Western Australia", lat-3, lat )) %>%
  dplyr::mutate(id = ifelse(id == "New South Wales", "New South Wales\n(196 letters)", id ),
                id = ifelse(id == "Queensland", "Queensland\n(16 letters)", id ),
                id = ifelse(id == "South Australia", "South Australia\n(31 letters)", id ),
                id = ifelse(id == "Tasmania", "Tasmania\n(28 letters)", id ),
                id = ifelse(id == "Victoria", "Victoria\n(240 letters)", id ),
                id = ifelse(id == "Western Australia", "Western Australia\n(87 letters)", id ))
# inspect
cnames
```



```{r}
# define colors
#library(scales)
#clrs <- viridis_pal()(15)
# inspect
clrs <- c("gray99",
          "gray99",
          "gray99",
          "gray99",
          "gray99",
          "gray99",
          "gray99",
          "gray40", # NSW
          "gray99",
          "gray95", # NT
          "gray90", # QLD
          "gray80", # SA
          "gray85", # TAS
          "gray25", # VIC
          "gray70") # wa
tclrs <- c("white", # NSW
          "gray20", # NT
          "gray20", # QLD
          "gray20", # SA
          "gray20", # TAS
          "white", # VIC
          "gray20") # wa
```


```{r}
# plot ozmap
p <- ggplot() +
  # plot map
  geom_polygon(data = ozmapt, 
               aes(x = long, y = lat, group = group, fill = id), 
               asp = 1, colour = NA) +
  # add text
  geom_text(data = cnames, aes(x = long, y = lat, label = id), 
            size = 2.5, color = tclrs, fontface = "bold", 
            check_overlap = T) +
  # color states
  scale_fill_manual(values = clrs) +
  # define theme and axes
  theme_void() +
  scale_x_continuous(name = "Longitude", limits = c(113, 155)) +
  scale_y_continuous(name = "Latitude", limits = c(-45, -10)) +
  # def. background color
  theme(panel.background = element_rect(fill = "slategray1",
                                        colour = "slategray1",
                                        size = 0.5, linetype = "solid"),
        legend.position = "none")
ggsave(file = here::here("images", "letter_map.png"), 
         height = 4,  width = 5, dpi = 320)
# show plot
p
```



# Outro

```{r}
sessionInfo()
```


# References