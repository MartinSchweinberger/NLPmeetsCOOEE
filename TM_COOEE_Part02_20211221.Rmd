---
title: "Analysis of the Corpus of Oz Early English - Part 2: Corpus Exploration"
author: "Anonymous"
date: "`r format(Sys.time(), '%Y-%m-%d')`"
output:
  bookdown::html_document2: default
bibliography: Bibliography.bib
link-citations: yes
---

# Introduction

This document shows an analysis of Corpus of Oz Early English  (COOEE) [@fritz2004cooee]. 

## Aims

* Find keywords

* **Check for distribution of keywords by date (mosaic plot) (part 3)

* **Create network of keywords (network analysis) (part 3)

* Find topics (topic modeling) (part 4)

* Error analysis (misspelled words, words not in dictionary) (part 5)

# Set Up

In a first step, the session is prepared by installing packages.


```{r ampause_01_01, eval = F, message=FALSE, warning=FALSE}
# load packages
install.packages("tidyverse")
install.packages("tidytext")
install.packages("tidyr")
install.packages("tm")
install.packages("tokenizers")
install.packages("qdap")
install.packages("textstem")
install.packages("corpus")
install.packages("quanteda")
install.packages("quanteda.textstats")
install.packages("ngram")
```

Now, we activate the packages, set options, load relevant functions, and defining the path to the data.

```{r}
# set options
options(stringsAsFactors = F)
options(scipen = 999)
# load packages
library(tidyverse)
library(tidytext)
library(tidyr)
library(tm)
library(tokenizers)
library(qdap)
library(textstem)
library(corpus)
library(quanteda)
library(quanteda.textstats)
library(ngram)
# for pos-tagging objects in R
source("D:\\R/POStagObject.R") 
```


In a next step, we load and process the corpus data.


```{r}
# cooee
cooee_clean  <- base::readRDS(file = here::here("data", "cooeed_clean.rda"))
# control
control_clean  <- base::readRDS(file = here::here("data", "control_clean.rda"))
# inspect
nrow(cooee_clean); nrow(control_clean)
```

# Corpus Exploration

## COOEE

```{r train, message=F, warning=F}
cooeetb <- cooee_clean %>%
  dplyr::filter(Register == "PcW") %>%
  dplyr::select(Birth, Gender, Origin, Age, Status, Arrival, Abode, YearWriting, 
                PlaceWriting, TextT, Words, Text, Datecat) %>%
  dplyr::mutate(Gender = dplyr::case_when(Gender == "m" ~ "male", 
                                          Gender == "f" ~ "female",
                                          TRUE ~ "unknown")) %>% 
  dplyr::mutate(Text = stringr::str_squish(Text)) %>%
  dplyr::rowwise() %>%
  dplyr::mutate(Tokens = length(unlist(tokenize_fasterword(Text))),
                Types = length(table(unlist(tokenize_fasterword(Text)))))
# inspect
head(cooeetb)
```

tab: date, gender, types, tokens



```{r}
tab01 <- cooeetb %>%
  dplyr::group_by(Datecat, Gender) %>%
  dplyr::summarise(Letters = n(),
                   Types = sum(Types),
                   Tokens = sum(Tokens),
                   MeanLength = round(Tokens/Letters, 1))
readr::write_delim(tab01, here::here("tables", "tab01.txt"), delim = "\t")
# inspect
tab01
```

```{r}
tab02 <- cooeetb %>%
  dplyr::group_by(Gender) %>%
  dplyr::summarise(Letters = n(),
                   Types = sum(Types),
                   Tokens = sum(Tokens))
readr::write_delim(tab02, here::here("tables", "tab02.txt"), delim = "\t")
# inspect
tab02
```

```{r}
# percent women
27/(378+27)*100
# average length
797569/405


```

## CLMP

```{r}
head(control_clean)
```


```{r train, message=F, warning=F}
controltb <- control_clean %>%
  dplyr::filter(Register == "PcW") %>%
  dplyr::select(YearWriting, Text, Datecat) %>%
  dplyr::mutate(Text = stringr::str_squish(Text)) %>%
  dplyr::rowwise() %>%
  dplyr::mutate(Tokens = length(unlist(tokenize_fasterword(Text))),
                Types = length(table(unlist(tokenize_fasterword(Text)))))
# inspect
head(controltb)
```

```{r}
tab03 <- controltb %>%
  dplyr::group_by(Datecat) %>%
  dplyr::summarise(Letters = n(),
                   Types = sum(Types),
                   Tokens = sum(Tokens),
                   MeanLength = round(Tokens/Letters, 1))
readr::write_delim(tab01, here::here("tables", "tab03.txt"), delim = "\t")
# inspect
tab03
```

# Outro

```{r}
sessionInfo()
```


# References